<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pick Calculator</title>
    <style>
        h1 {text-align: center;}

        .inputs {
            display: flex;
        }

        .labels {
            display: flex;
            width: 122px;
            flex-direction: column;
        }

        .labels > p {
            margin: 4px;
            text-align: right;
        }
       
        .inputBoxes > input {
            margin: 2px;
        }

        .inputBoxes {
            display: flex;
            flex-direction: column;
            align-items: start;
        }
 
        #inputBoxes > #flexBool {
            margin-top: 7px;
        }

        #flexSettings {
            margin-top: 10px;
        }

        #timeUpdated {
            color: rgb(83, 88, 109);
            font-size: 15px;
        }
    </style>
</head>
<body>
    <h1>Pick Calculator</h1>
    <div id="inputs">
        <p id="timeUpdated">10:10AM</p>
    </div>
    <div id="inputs" class="inputs">
        <div id="labels" class="labels">
            <p>Pick Lists:</p>
            <p>Active Pickers:</p>
            <p>Picklist Duration:</p>
            <p>Goal End Time:</p>
            <p>Flex?</p>
        </div>
        <div id="inputBoxes" class="inputBoxes">
            <input type="number" id="lists" name="lists" oninput="calculateTime()">
            <input type="number" id="pickers" name="pickers" oninput="calculateTime()">
            <input type="number" id="listTime" name="pickDuration" oninput="calculateTime()">
            <input type="time" id="endTime" name="endTime" value="11:10" oninput="calculateTime()">
            <input type="checkbox" id="flexBool" name="flexBool" value="false" oninput="flex()">
        </div>
    </div>
    <div id="flexSettings" class="inputs">
        <div id="flexLabels" class="labels">
            <p>Pick Lists:</p>
            <p>Picklist Duration:</p>
        </div>
        <div id="flexInputs" class="inputBoxes">
            <input type="number" id="lists" name="lists" oninput="calculateTime()">
            <input type="number" id="listTime" name="pickDuration" oninput="calculateTime()">
        </div>
    </div>

    <div id="outputs">
        <p id="cartsPerPerson">Carts Per Person:</p>
        <p id="mintuesToEnd">Pick Minutes Left:</p>
        <p id="minutesToGoalEnd">Minutes To Goal Time:</p>
        <p id="estimatedEndTime">Estimated End Time:</p>
        <p id="peopleNeeded">Minimum Pickers Required:</p>
        <p id="manMinutes">Man Minutes Of Work:</p>
    </div>
</body>
<script>
    // Main function to calculate time
    function calculateTime() {
        let pickLists = document.getElementById("lists").value;
        let activePickers = document.getElementById("pickers").value;
        let pickDuration = document.getElementById("listTime").value;
        
        let cartsPerPerson = Math.ceil(pickLists / activePickers);
        let timeLeft = Math.ceil((pickLists / activePickers) * pickDuration);
        grabTime(pickLists, pickDuration, timeLeft, activePickers);

        if(activePickers < 1) { return };
        document.getElementById("mintuesToEnd").innerHTML = "Pick Minutes Left: " + timeLeft;
        document.getElementById("cartsPerPerson").innerHTML = "Carts Per Person: " + cartsPerPerson;
    }

    // Grabs current time
    function grabTime(pl, pd, tl, ap) {
        let now = new Date();
        let [hours, mins] = document.getElementById("endTime").value.split(":");
        let minutesToEnd = (hours * 60 + mins * 1) - (now.getHours() * 60 + now.getMinutes() * 1);
        if(minutesToEnd < 1) {
            document.getElementById("minutesToGoalEnd").innerHTML = "Minutes To Goal Time: " + Math.abs(minutesToEnd) + " Over";
        } else {
            document.getElementById("minutesToGoalEnd").innerHTML = "Minutes To Goal Time: " + minutesToEnd;
        }
        let manMinutes = pl * pd;
        document.getElementById("manMinutes").innerHTML = "Man Minutes Of Work: " + manMinutes;
        let peopleNeeded = Math.ceil(manMinutes / minutesToEnd);
        if(peopleNeeded > 100) {document.getElementById("peopleNeeded").innerHTML = "Minimum Pickers Required: >100";} else {
            document.getElementById("peopleNeeded").innerHTML = "Minimum Pickers Required: " + peopleNeeded;
        }
        let estEndTime = new Date();
        estEndTime.setMinutes(now.getMinutes() + tl);
        estEndTime = new Date(estEndTime);
        if(ap < 1) { return };
        document.getElementById("estimatedEndTime").innerHTML = "Estimated End Time: " + hours12(estEndTime) + ":" + pad(estEndTime.getMinutes());
        document.getElementById("timeUpdated").innerHTML = "Last Updated At " + hours12(now) + ":" + pad(now.getMinutes());
    }

    function hours12(date) { 
        let hr12 = (date.getHours() + 24) % 12 || 12; 
        return pad(hr12);
    }

    function pad(n) {
        return (n < 10) ? '0' + n : n;
    }

    function flex() {
    }

    setInterval(calculateTime, 10000);

    // Made by Nicholas Hatchew (nhatchew). Last Updated 02/12/2024
    // Work in progress system to refine pick and stage VTO calculations and Estimated time left
    
</script>
</html>